# 4주차

## 1

## 네트워크 공격 발생 원인

TCP/IP는 연결성을 위해 디자인 됨

: **송신자 및 수신자 간 신용이 존재한다는 가정**이 있어서 보안 메커니즘이 많이 빠져있다

</br>

네트워크 기기의 취약점

: **계속적인 버그**가 계속적인 공격의 원인

</br></br>

## IP공격

#### Adress 스푸핑

 : 누군가 악의적으로 IP adress를 변경 했을 때

(A,B,S : 클라이언트, C: 호스트)

- ARP 스푸핑 : A가 마치 B인것 처럼 S에게 보이는 것
- 소스 라우팅 : C가 마치 B인 것처럼 S에게 보이는 것

</br>

#### IP 단편화 공격

 : 메세지를 하나의 IP 패킷에 보낼 수 없는 경우 메시지를 잘개 쪼개(단편화) 수신자에게 보낸다. 누군가 임의로 조작한다면 다시 합치는 작업을 할 때 여러 문제가 발생한다.

</br>

#### 트래픽 증폭 공격 

: 불특정 다수에게 메시지를 보낼 수 있는 브로드캐스팅을 허용했기에 공격자들이 엄청나게 많은 패킷들을 증폭시켜 특정 호스트에게 공격을 보낸다. 

</br>

#### PING flood

: 트래픽을 증폭시키는 메커니즘을 사용해서 공격을 하고 싶어 한다. 이 경우 공격 시스템은 인터넷을 통해 브로드캐스팅이 허용된 네트워크로 여러개의 Ping 메시지를 보낸다. 브로드 캐스팅이 허용된 네트워크에서는 **Ping 응답을 공격시스템으로 보내는게 아니라 그 Ping request의 소스  Address가 피해 시스템으로 되어 있어 다 피해 시스템으로 증폭되어 전달**된다.

</br></br>

## TCP 계층 공격

#### 3Way 핸드셰이킹

1. 클라이언트가 서버로 SYN Request를 보냄
2. 서버에서 Request에 대한 ACK를 보냄, SYN request를 포함해서 보냄
3. SYN request에 응답

</br>

#### TCP SYN Flooding

Request만 보내고 마지막 ACK를 보내지 않음으로써 서버에서 **리소스를 사용**하게함. 리소스가 **엄청난 Request**를 보내면서 서버를 다운 시킴. 서버가 **더이상의 메시지 Request처리를 하지 못하게 공격하는 것**

1. SYN패킷 전송, ACK에 미응답
2. 서버는 ACK에 대한 응답을 511초간 대기
3. 완료되지 않은 연결에 대한 관리가 유한한 큐에서 이루어짐
4. 큐가 꽉 찬다면 더이상의 요청을 처리 못하는식

</br></br>

## 어플리케이션 계층 공격

#### Mail Bomb

누군가에게 스팸메일을 매우 많이 보내어 메일서버의 디스크를 꽉차게 하는 공격 방법

</br>

#### 디도스 공격

공격자 : 공격을 주도하는 해커의 컴퓨터

마스터 : 공격자에게서 직접 명령을 받는 시스템, 여러대의 에이전트를 관리하는 시스템

에이전트 : 공격대상을 직접 공격하는 시스템

에이전트를 활용해서 한번에 동시다발적으로 공격대상에게 이루어지게끔 공격하는 경우가 **DDOS attack**

에이전트를 활용해서 대리로 공격하기에 발원지를 찾기 힘들다

</br></br>

## 2

#### 방화벽의 기능과 목적

사용자들이 시스템을 최신상태로 유지하지 않다.

</br>

#### 네트워크 보안 취약점 해결방안

##### 방화벽의 기능

- 네트워크에서 보안을 높이는데 가장 1차적인 방식
- 신뢰하지 않는 외부 네트워크와 신뢰하는 내부 네트워크 사이를 지나가는 모든 패킷을 차단하거나 보내주는 기능이 있다.

1. 접근제어
2. 로깅과 감사추적
3. 인증
4. 데이터 암호화

</br>

#### 스크리닝 라우터

라우터의 방화벽을 설치하여 원치 않는 패킷이 내부로 들어오는 것을 막아주는 개념

3계층인 네트워크 계층, 4계층인 전송 계층에서 실행

IP주소와 포트에 대한 **접근제어**가 가능

외부 네트워크와 내부 네트워크의 경계선

*라우터에 패킷 필터링 규칙을 적용하는 것으로 **방화벽 역할**을 수행한다*

</br>

#### 패킷 필터링의 개념

허용하지 않는 서비스에 대해 **거부하는 기능**

**설정 과정**

1. 허용할 서비스 확인
2. 제공하려는 서비스에 보안 문제점 및 허용에 대한 타당성 검토
3. 서비스가 이루어 지는 형태 확인 및 어떤 규칙을 적용할지 결정
4. 방화벽에 실제 적용 및 적용된 규칙 검사

</br>

#### Intrusion Detection System

데이터와 호스트의 행동 모니터링

공격 감지 시 리포트

##### <유형>

1. 시그니처 기반 IDS

   알려진 공격 패턴을 비교 매칭

2. 변칙 기반 IDS

   통계 또는 머신러닝을 활용하여 정상적인 유형의 행동들을 규정. 여기에 반하는 행동을 비정상으로 규정

3. 호스트 기반 IDS

   가공되지 않은 패킷들을 분석

4. 네트워크 기반 IDS

   단일 호스트 위에서 동작. 로그 등을 분석

</br></br>

## 3

####  풋프린팅

공격 대상, 타깃의 정보를 모으는 방법.

해킹전 해킹을 위한 사전 작업

</br>

##### 스캐닝

서비스를 제공하는 서버의 작동 여부와 서버가 제공해 주는 여러가지 서비스들을 확인하는 방법

스캔은 **방화벽과 IDS를 우회하기 위해** 발전

1. Ping과 ICMP 스캔

   ping을 활용해서 공격대상이 현재 네트워크에서 돌아가고 있다는 것을 확인

2. TCP Open 스캔

   가장 기본적인 스캔 기법. 

   3way핸드셰이킹이 정상적으로 작동하면 공격하고자 하는 서비스가 현재 돌아가고 있다는 것을 확인.

   포트가 닫혀 있을 경우. 즉, 서비스가 돌아가지 않는 경우 타깃 쪽에서 RST와 ACK를 보냄. 이렇게 공격자 측은 서비스가 돌아가지 않는 다는 것을 알 수 있음

   **TCP Open은 TCP세션이 맺어질 경우 공격자가 누군지 증거가 남는다.**

3. 스텔스 스캔

   세션을 완전히 성립하지 않고 공격 대상 시스템의 포트 활성화 여부를 알아낸다. 따라서 공격 대상 시스템에 로그가 남지 않는다.

   **TPC Half Open 스캔** : 대표적인 스텔스 스캔의 예제

   1. 공격자가 SYN패킷을 공격대상에게 보냄
   2. 공격대상은 포트가 열려있을 경우 SYN과 ACK를 보냄
   3. 공격자는 SYN과 ACK를 받는 순간 RST패킷을 전송하여(리셋 패킷) 즉시 연결을 끊음

4. UDP 스캔

   포트가 닫혀 있는 경우 ICMP Unreachable 패킷이 돌아온다.

   열려있는 경우 UDP프로토콜 특성상 패킷을 받고(공격자가 보낸 UDP패킷) 종료가 된다.

   **UDP 스캔은 TCP 포트 스캔보다 신뢰성이 떨어진다.**

   - UDP패킷이 네트워크를 통해 전달되는 동안 라우터나 방어벽에 의해 손실될 수 있기 때문

</br>

#### fping과 nmap

상대 호스트가 네트워크에 연결이 되어 있는지, 그리고 그 호스트에서 돌아가고 있는 포트, 즉 서비스들이 무엇이 있는지 확인하는 툴





